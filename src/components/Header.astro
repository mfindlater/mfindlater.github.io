---
import menuImage from "../assets/img/menu.svg";
import closeImage from "../assets/img/x.svg";
import sunImage from "../assets/img/sun.svg";
import moonImage from "../assets/img/moon.svg";
import { Image } from "astro:assets";
---

<header class="sticky mt-4 flex flex-col items-center px-4 py-2 shadow dark:shadow-onyx-400">
  <div class="flex items-center justify-center w-full relative">
    <!-- Mobile menu button positioned absolutely on the left -->
    <div class="absolute left-0 md:hidden">
      <button
        id="menuButton"
        class="cursor-pointer"
        aria-label="Menu"
        type="button"
        aria-expanded="false"
      >
        <Image
          src={menuImage}
          alt="Menu"
          class="menu-icon w-[32px] dark:invert"
          loading="eager"
        />
        <Image
          src={closeImage}
          alt="Close"
          class="close-icon hidden w-[32px] dark:invert"
          loading="eager"
        />
      </button>
    </div>

    <h1 class="text-4xl font-extrabold text-center dark:text-alabaster-500">Matthew Findlater</h1>

    <!-- Dark mode toggle positioned absolutely on the right -->
    <div class="absolute right-0">
      <button
        id="themeToggle"
        class="cursor-pointer p-1"
        aria-label="Toggle dark mode"
        type="button"
      >
        <Image
          src={moonImage}
          alt="Dark mode"
          id="moonIcon"
          class="w-[24px]"
          loading="eager"
        />
        <Image
          src={sunImage}
          alt="Light mode"
          id="sunIcon"
          class="hidden w-[24px] invert"
          loading="eager"
        />
      </button>
    </div>
  </div>

  <!-- Navigation links -->
  <nav id="mobileNav" class="hidden md:block w-full">
    <ol class="flex flex-col md:flex-row md:justify-center md:gap-8 mt-4">
      <li>
        <a
          href="/"
          class="text-lg font-bold block hover:shadow hover:outline-2 rounded p-2 md:inline-block dark:text-alabaster-500"
          >Home</a
        >
      </li>
    </ol>
  </nav>
</header>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    // Mobile menu toggle
    const menuButton = document.getElementById("menuButton");
    const mobileNav = document.getElementById("mobileNav");
    const menuIcon = document.querySelector(".menu-icon");
    const closeIcon = document.querySelector(".close-icon");

    if (menuButton && mobileNav && menuIcon && closeIcon) {
      menuButton.addEventListener("click", () => {
        mobileNav.classList.toggle("hidden");
        menuIcon.classList.toggle("hidden");
        closeIcon.classList.toggle("hidden");
        const isExpanded = menuButton.getAttribute("aria-expanded") === "true";
        menuButton.setAttribute("aria-expanded", (!isExpanded).toString());
      });
    }

    // Dark mode toggle
    const themeToggle = document.getElementById("themeToggle");
    const moonIcon = document.getElementById("moonIcon");
    const sunIcon = document.getElementById("sunIcon");

    function updateIcons() {
      const isDark = document.documentElement.classList.contains("dark");
      if (moonIcon && sunIcon) {
        moonIcon.classList.toggle("hidden", isDark);
        sunIcon.classList.toggle("hidden", !isDark);
      }
    }

    updateIcons();

    if (themeToggle) {
      themeToggle.addEventListener("click", () => {
        document.documentElement.classList.toggle("dark");
        const isDark = document.documentElement.classList.contains("dark");
        localStorage.setItem("theme", isDark ? "dark" : "light");
        updateIcons();
      });
    }
  });
</script>

<style>
  #mobileNav {
    transition: all 0.3s ease-in-out;
  }

  @media (max-width: 768px) {
    #mobileNav:not(.hidden) {
      display: block;
      animation: slideDown 0.3s ease-in-out;
    }
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
